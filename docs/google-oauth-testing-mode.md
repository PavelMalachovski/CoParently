# Режим тестирования OAuth (Testing Mode)

Если вы видите сообщение:
> "CoParently has not completed the google verification process. The app is currently being tested, and can only be accessed by developer-approved testers."

Это означает, что ваше приложение находится в **Testing** режиме OAuth consent screen.

## Что это означает?

- ✅ OAuth consent screen настроен правильно
- ✅ Приложение работает только для тестовых пользователей
- ⚠️ Только пользователи, добавленные в список тестеров, могут войти
- ⚠️ Обычные пользователи не смогут использовать Google Sign-In

## Решение 1: Добавление тестовых пользователей (для разработки)

### Шаг 1: Добавление тестовых пользователей

1. Откройте [Google Cloud Console](https://console.cloud.google.com/)
2. Выберите проект `coparently-a39c9`
3. Перейдите в **APIs & Services** → **OAuth consent screen**
4. Прокрутите вниз до раздела **Test users**
5. Нажмите **+ ADD USERS**
6. Введите email адреса пользователей, которым нужно предоставить доступ:
   - Ваш email (для тестирования)
   - Email соавтора (если есть)
   - Тестовые email аккаунты Google
7. Нажмите **ADD**
8. Сохраните изменения

### Шаг 2: Проверка работы

1. Убедитесь, что пользователь добавлен в список **Test users**
2. Пользователь должен выйти из всех Google аккаунтов в браузере
3. Пользователь должен использовать Google аккаунт, который добавлен в тестеры
4. Запустите приложение и попробуйте войти

### Важно для тестовых пользователей

- Тестовый пользователь должен использовать **тот же Google аккаунт**, email которого добавлен в список
- Если пользователь уже вошел в другой аккаунт, нужно выйти и войти снова
- После добавления нового тестера может потребоваться несколько минут для активации

## Решение 2: Публикация приложения (для production)

Если приложение готово к использованию широкой аудиторией, можно опубликовать OAuth consent screen.

### Требования для публикации

1. ✅ OAuth consent screen полностью настроен
2. ✅ Privacy Policy добавлена (если требуется)
3. ✅ Terms of Service добавлены (если требуется)
4. ✅ Scopes настроены правильно
5. ✅ Приложение соответствует политике Google

### Шаг 1: Подготовка к публикации

1. В **Google Cloud Console** → **APIs & Services** → **OAuth consent screen**
2. Проверьте все настройки:
   - **App information** - заполнено
   - **App domain** - добавлен (если есть веб-сайт)
   - **Authorized domains** - добавлены
   - **Developer contact information** - заполнен
   - **Scopes** - добавлены только необходимые
   - **Test users** - можно оставить для тестирования

### Шаг 2: Добавление Privacy Policy (если требуется)

Google может требовать Privacy Policy для приложений, которые:
- Запрашивают чувствительные scopes
- Обрабатывают пользовательские данные
- Работают с личной информацией

**Варианты:**
1. Создать страницу Privacy Policy на вашем сайте
2. Использовать генератор Privacy Policy
3. Добавить в GitHub Pages или другой хостинг

**Пример URL для Privacy Policy:**
```
https://coparently.app/privacy-policy
```

### Шаг 3: Подача на верификацию

1. В **OAuth consent screen** прокрутите вниз
2. Найдите раздел **Publishing status**
3. Нажмите **PUBLISH APP**
4. Подтвердите публикацию

### Шаг 4: Ожидание верификации

- **Время верификации**: обычно 1-7 дней
- Google может запросить дополнительную информацию
- Проверьте email на уведомления от Google

### Шаг 5: После публикации

- ✅ Все пользователи смогут использовать Google Sign-In
- ✅ Не нужно добавлять пользователей в список тестеров
- ⚠️ При изменении scopes может потребоваться повторная верификация

## Решение 3: Для внутреннего использования (Internal)

Если приложение используется только внутри вашей организации:

1. В **OAuth consent screen** → **User Type**
2. Выберите **Internal** (вместо External)
3. Это доступно только для Google Workspace организаций
4. В этом случае верификация не требуется

## Текущая рекомендация для CoParently

### Для разработки и тестирования:

1. **Используйте режим Testing** (текущий)
2. Добавьте тестовых пользователей в **Test users**
3. Это позволит тестировать приложение без публикации

### Для production:

1. Добавьте Privacy Policy (если требуется)
2. Убедитесь, что все scopes необходимы
3. Подайте на публикацию через **PUBLISH APP**
4. Дождитесь верификации Google

## Проверка статуса

Чтобы проверить текущий статус:

1. **Google Cloud Console** → **APIs & Services** → **OAuth consent screen**
2. Посмотрите раздел **Publishing status**:
   - **Testing** - только тестеры
   - **In production** - все пользователи
   - **Publishing** - на проверке

## Список тестовых пользователей

Текущие тестовые пользователи можно посмотреть в:
- **OAuth consent screen** → **Test users**

Для добавления:
1. Нажмите **+ ADD USERS**
2. Введите email
3. Нажмите **ADD**

**Ограничения:**
- Максимум 100 тестовых пользователей
- Пользователи должны иметь Google аккаунт

## Частые проблемы

### Проблема: "User is not a test user"

**Решение:**
- Убедитесь, что email пользователя добавлен в **Test users**
- Пользователь должен использовать тот же Google аккаунт
- Подождите несколько минут после добавления

### Проблема: "App verification required"

**Решение:**
- Это нормально для Testing режима
- Для production нужно пройти верификацию
- Пока используйте тестовых пользователей

### Проблема: Пользователь не может войти

**Решение:**
1. Проверьте, что email добавлен в Test users
2. Убедитесь, что пользователь использует правильный Google аккаунт
3. Попросите пользователя выйти из всех Google аккаунтов и войти снова
4. Проверьте, что приложение правильно настроено

## Дополнительные ресурсы

- [OAuth Consent Screen Documentation](https://support.google.com/cloud/answer/10311615)
- [Google OAuth Verification](https://support.google.com/cloud/answer/9110914)
- [Privacy Policy Requirements](https://support.google.com/cloud/answer/10311615#privacy-policy)

## Быстрая проверка

✅ **Режим Testing активен** - добавьте тестовых пользователей
✅ **Готово к production** - подайте на публикацию
✅ **Только внутреннее использование** - переключите на Internal (если доступно)

